{%- comment -%}
  Parameters
  * fields
  * class
{%- endcomment -%}

{%- if fields != blank -%}
  {%- for enable in fields.enable -%}
    {%- if enable -%}
      {%- assign image = fields.image[forloop.index0][0].src -%}
      {%- assign image_s = fields.image_s[forloop.index0][0].src -%}
      {%- assign image_l = fields.image_l[forloop.index0][0].src -%}
      {%- assign image_alt = fields.image_l[forloop.index0][0].alt -%}

      {%- capture image_sources -%}
        {%- if image != blank -%}
          {{- image -}}
        {%- endif -%}
        {%- if image_s != blank -%}
          |{{- image_s -}}
        {%- endif -%}
        {%- if image_l != blank -%}
          |{{- image_l -}}
        {%- endif -%}
      {%- endcapture -%}

      {%- capture breakpoints -%}
        {%- if image != blank -%}
          (max-width: 767px)
        {%- endif -%}
        {%- if image_s != blank -%}
          |(max-width: 999px)
        {%- endif -%}
        {%- if image_l != blank -%}
          |(min-width: 1000px)
        {%- endif -%}
      {%- endcapture -%}

      {%- render 'text-and-image' with fields.media_type[forloop.index0] as media_type,
        class: 'page-flex__item flex-text-and-image',
        order: fields.order[forloop.index0],
        inverted_mode: fields.inverted_mode[forloop.index0],
        image_sources: image_sources,
        breakpoints: breakpoints,
        image_alt: image_alt,
        video: fields.video[forloop.index0],
        video_s: fields.video_s[forloop.index0],
        video_l: fields.video_l[forloop.index0],
        fallback: image_mobile,
        fallback_s: image_intermediate,
        fallback_l: image,
        tagline: fields.tagline[forloop.index0],
        title: fields.title[forloop.index0],
        text: fields.text[forloop.index0],
        cta_url: fields.cta_url[forloop.index0],
        cta_text: fields.cta_text[forloop.index0],
        cta_new_window: fields.cta_new_window[forloop.index0],
        content_alignment: fields.content_alignment[forloop.index0],
        text_alignment: fields.text_alignment[forloop.index0]
      -%}
    {%- endif -%}
  {%- endfor -%}
{%- endif -%}
