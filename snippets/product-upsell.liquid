{%- comment -%}
  Parameters
  * title
  * products
  * enable_carousel
{%- endcomment -%}

{%- assign enable_carousel = enable_carousel | default: false -%}

{%- if products.size > 0 -%}
  <div class="product-upsell" data-module="product-upsell" v-cloak data-a-group>
    {%- if title -%}
      <p class="product-upsell__title">
        {{- title -}}
      </p>
    {%- endif -%}

    {%- if enable_carousel == false -%}
      <div class="product-upsell__carousel product-upsell__carousel--stacked">
        {%- for product_handle in products -%}
          {%- render 'product-upsell-item', product: all_products[product_handle] -%}
        {%- endfor -%}
      </div>
    {%- else -%}
      <div data-a-stagger>
        {%- render 'carousel',
          class: 'product-upsell__carousel',
          columns: 1,
          columns_s: 1,
          columns_m: 1,
          columns_l: 1,
          card: 'upsell-item',
          class_card: 'product-upsell__slide',
          items: products,
          page_dots: false,
          prev_next_buttons: true,
          watch_css: true,
          bind_dynamic_props: false,
          is_vue: true,
          align_arrows_to_image: true,
          group_cells: true,
          contain: true,
          cell_align: 'left' -%}
      </div>
    {%- endif -%}
  </div>
{%- endif -%}
