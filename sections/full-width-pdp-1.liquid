{%- assign blocks = section.blocks -%}
{%- assign image = section.settings.image | img_url: '2160x' -%}
{%- assign image_intermediate = section.settings['image_intermediate'] | img_url: '1200x' -%}
{%- assign image_mobile = section.settings['image_mobile'] | img_url: '700x' -%}
{%- assign image_alt = image.alt -%}

{%- capture image_sources -%}
  {%- if image_mobile != blank -%}
    {{- image_mobile -}}
  {%- endif -%}
  {%- if image_intermediate != blank -%}
    |{{- image_intermediate -}}
  {%- endif -%}
  {%- if image != blank -%}
    |{{- image -}}
  {%- endif -%}
{%- endcapture  -%}

{%- capture breakpoints -%}
  {%- if image_mobile != blank -%}
    (max-width: 767px)
  {%- endif -%}
  {%- if image_intermediate != blank -%}
    |(max-width: 999px)
  {%- endif -%}
  {%- if image != blank -%}
    |(min-width: 1000px)
  {%- endif -%}
{%- endcapture  -%}

{%- capture additional_content -%}
{%- render 'icon-text-grid',
  items: blocks,
  grid_class: 'icon-text-grid--full-width' -%}
{%- endcapture -%}

{%- if section.settings.enable_section -%}
  {%- render 'full-width' with section.settings['background_type'] as background_type,
    inverted_mode: section.settings.inverted_mode,
    enable_overlay: section.settings.enable_overlay,
    overlay_opacity: section.settings.overlay_opacity,
    breakpoints: breakpoints,
    image_sources: image_sources,
    image_alt: image_alt,
    video: section.settings['video'],
    video_s: section.settings['video_s'],
    video_l: section.settings['video_l'],
    fallback: image_mobile,
    fallback_s: image_intermediate,
    fallback_l: image,
    tagline: section.settings.tagline,
    title: section.settings.title,
    text: section.settings.text,
    additional_content: additional_content -%}
{%- endif -%}

{% schema %}
{
  "name": "Full Width Content",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_section",
      "label": "Enable this Section",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "inverted_mode",
      "label": "Inverted mode"
    },
    {
      "type": "checkbox",
      "id": "enable_overlay",
      "label": "Enable overlay"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 50
    },
    {
      "type": "header",
      "content": "Background"
    },
    {
      "type": "select",
      "id": "background_type",
      "label": "Background Type",
      "options": [
        {
          "value": "image",
          "label": "Image"
        },
        {
          "value": "video",
          "label": "Video"
        },
        {
          "value": "none",
          "label": "None"
        }
      ],
      "default": "image"
    },
    {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "Image (Mobile)",
      "info": "Upload a JPEG of ~ 700px."
    },
    {
      "type": "image_picker",
      "id": "image_intermediate",
      "label": "Image (Intermediate)",
      "info": "Upload a JPEG of ~ 1200px."
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image (Desktop)",
      "info": "Upload a JPEG of ~ 2160px."
    },
    {
      "type": "text",
      "id": "video",
      "label": "Video URL (Mobile)",
      "info": "MP4 url. E.g. MP4 link from Vimeo Pro."
    },
    {
      "type": "text",
      "id": "video_s",
      "label": "Video URL (Intermediate)",
      "info": "MP4 url. E.g. MP4 link from Vimeo Pro."
    },
    {
      "type": "text",
      "id": "video_l",
      "label": "Video URL (Desktop)",
      "info": "MP4 url. E.g. MP4 link from Vimeo Pro."
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "tagline",
      "label": "Tagline (Optional)"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title"
    },
    {
      "type": "textarea",
      "id": "text",
      "label": "Text (Optional)"
    }
  ],
  "blocks": [
    {
      "type": "icon-text",
      "name": "Icon + Text",
      "limit": 3,
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label"
        },
        {
          "type": "textarea",
          "id": "text",
          "label": "Text"
        },
        {
          "type": "select",
          "id": "icon_type",
          "label": "Icon Type",
          "options": [
            {
              "value": "svg",
              "label": "SVG"
            },
            {
              "value": "jpeg-png",
              "label": "JPEG/PNG"
            }
          ],
          "default": "jpeg-png"
        },
        {
          "type": "text",
          "id": "icon_svg",
          "label": "Icon SVG",
          "info": "Enter SVG file name, should be uploaded in Settings/Files"
        },
        {
          "type": "image_picker",
          "id": "icon_jpeg_png",
          "label": "Icon JPEG/PNG"
        }
      ]
    }
  ]
}
{% endschema %}
